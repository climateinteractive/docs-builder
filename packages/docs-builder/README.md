# @climateinteractive/docs-builder

This package provides a command line tool (`docs-builder`) that can generate
a static website that contains user-facing documentation.

It takes Markdown source files and produces a site that is similar in
design to ReadTheDocs.

It has no server-side dependencies (including for search, which is purely
client-side), so the generated docs can be tested easily on localhost.

The Markdown files can contain [special tags](#syntax) that provide precise control over
how blocks of text are made available for translation.

## Install

Note: The package is currently only published to the GitHub Packages registry,
so you will first need to add the following line to your `.npmrc` file:

```
@climateinteractive:registry=https://npm.pkg.github.com
```

Once the `.npmrc` file is updated, you can install the package the usual way:

```
$ npm install @climateinteractive/docs-builder
```

## Usage

### Command Line

```sh
# Build the docs (in the `projects` directory) and output
# to the `public` directory
$ docs-builder

# Or, enable development mode, which runs the builder in
# watch mode and starts a local development server so that
# you can see your docs in the browser immediately
$ docs-builder dev
```

### API

You can also run the builder programmatically as part of another tool using
the `buildDocs` function:

```js
import { buildDocs } from '@climateinteractive/docs-builder'

async function main() {
  await buildDocs({
    mode: 'production',
    projDir: path.resolve(process.cwd(), 'projects', 'my-docs'),
    sourceDir: path.resolve(process.cwd(), 'projects', '_shared', 'src')
  })
}
```

## Project Layout

The `docs-builder` tool expects a certain layout for your documentation project(s):

```
my-docs-project/
  package.json

  projects/
    _shared/
      src/
        base.css
        favicon.ico
        search.js
        support.js
        template-complete.html
        template-default.html
        template-error.html
        template-simple.html

    my-docs/
      .config.json
      index.md
      project.css
      localization/
        en/
          docs.po # strings to be translated (generated by docs-builder)
          images/
            my-image.png
        de/
          docs.po # strings translated into German (edited by a human)
          images/
            my-image.png # translated image (overrides English one)
        ...
```

See the [sample-docs](../../examples/sample-docs) project in this repo for a
working example.

## Syntax

Documentation pages processed by `docs-builder` can be authored using typical
[Markdown](https://www.markdownguide.org/getting-started/) syntax.
This format is relatively easy to learn and can be translated into other formats, such as HTML.

Refer to the [Markdown Guide](https://www.markdownguide.org/) for more on:

- [Basic Syntax](https://www.markdownguide.org/basic-syntax/) (headings, lists, bold/italic, etc)
- [Extended Syntax](https://www.markdownguide.org/extended-syntax/) (tables, code blocks, etc)

### Custom Commands

The `docs-builder` tool has support for a few custom "commands" that can be used
to fine tune how the documentation is generated:

- `def`: define a single sentence or paragraph of text to be made available for translation
- `begin-def` / `end-def`: capture multiple paragraphs into a single block of text to be
  made available for translation
- `section`: define the "slug" for a section, which is used to build anchor names and keys
  for string translation

These commands are optional if you are building documentation in a single language, but are
essential if you want to make your documentation available in multiple languages.

Commands are specified using normal HTML comment syntax; this means the files
are still valid/normal Markdown files, and this allows the files to be be opened
in any Markdown editor. For example:

```md
# <!-- section:page_1 --><!-- def:title -->Page 1

## <!-- section:examples -->:section_examples:

<!-- def:intro -->

This is the first example on the first [page][glossary_page].

<!-- begin-def:example_1 -->

This is a sentence with **bold** and _italic_ text.

This block has two paragraphs that are captured using a
`begin-def` / `end-def` pair.

<!-- end-def -->
```

TODO: Add more documentation about custom commands. For the time being, refer
to the examples on
[this page](../../examples/sample-docs/projects/sample-guide/content/page_1.md)
in the [sample-docs](../../examples/sample-docs) project.

## License

`docs-builder` is distributed under the MIT license. See `LICENSE` for more details.
